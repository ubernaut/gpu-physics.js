import{W as E,V as c,P as I,G as C,O as G,c as j}from"./orbitControls-DtLyUrbL.js";import{B as S}from"./boxRenderer-DyEUWp37.js";async function V(){const r=document.getElementById("canvas");document.getElementById("error");const e=new E({maxBodies:2048,maxParticles:32768,radius:.05,stiffness:1200,damping:4,friction:.9,drag:.2,fixedTimeStep:1/120,gravity:new c(0,-3,0),boxSize:new c(8,8,8),gridPosition:new c(-8,0,-8),gridResolution:new c(96,48,96)});await e.ready();const m=new S(e.getDevice(),r),f=new I(e.getDevice()),B=new C(e.getDevice(),m.format,{size:20,height:0}),P=new G(r,{radius:14,target:[0,.5,0]}),i={showParticles:!0,paused:!1,batch:40},t=3,g=e.radius*2.01,w=j(1,new c(e.radius*t,e.radius*t,e.radius*t)),u=[0,0,0,1];function b(n,o,p){const h=e.addBody(n,o,p,u[0],u[1],u[2],u[3],1,w.x,w.y,w.z);for(let a=0;a<t;a++)for(let d=0;d<t;d++)for(let s=0;s<t;s++)if(a===0||a===t-1||d===0||d===t-1||s===0||s===t-1){const R=(a-(t-1)*.5)*g,v=(d-(t-1)*.5)*g,z=(s-(t-1)*.5)*g;e.addParticle(h,R,v,z)}}function x(n){for(let o=0;o<n;o++){const p=(Math.random()-.5)*4,h=.5+o*.05,a=(Math.random()-.5)*4;b(p,h,a)}}x(200);const l=new window.lil.GUI({title:"Container"});l.add(i,"showParticles"),l.add(i,"paused"),l.add(i,"batch",10,200,1).name("add count"),l.add({add:()=>x(i.batch)},"add").name("add more"),e.step(e.fixedTimeStep||1/60);function y(){i.paused||e.step(1/60);const n=P.getViewProj(r.width/r.height);m.updateBindGroup(e.getBodyPositionBuffer(),e.getBodyQuaternionBuffer()),f.updateBindGroup(e.getParticleWorldPositionBuffer()),f.updateViewProj(n,e.radius),m.render(e.bodyCount,{viewProj:n,drawExtras:o=>{B.update(n,{gridSize:.4,lineWidth:.03,height:0}),B.record(o),i.showParticles&&f.record(o,e.particleCount)}}),requestAnimationFrame(y)}y()}V().catch(r=>{const e=document.getElementById("error");e.textContent=`Error: ${r.message||r}`,console.error(r)});
