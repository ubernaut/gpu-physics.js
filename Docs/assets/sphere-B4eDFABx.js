import{W as j,V as g,P as T,G as V,O as W,c as D}from"./orbitControls-DtLyUrbL.js";import{B as O}from"./boxRenderer-DyEUWp37.js";async function Y(){const i=document.getElementById("canvas");document.getElementById("error");const w=document.getElementById("bodyCount"),E=document.getElementById("fps"),e=new j({maxBodies:1024,maxParticles:16384,radius:.08,stiffness:140,damping:.6,friction:.35,drag:.25,fixedTimeStep:1/90,gravity:new g(0,-2,0),boxSize:new g(15,15,15),gridPosition:new g(-15,0,-15),gridResolution:new g(96,48,96),maxSubSteps:8});await e.ready();const y=new O(e.getDevice(),i),x=new T(e.getDevice()),R=new V(e.getDevice(),y.format,{size:30,height:0}),v=new W(i,{radius:16,target:[0,.5,0]}),o={sphereRadius:1.5,stiffness:e.stiffness,damping:e.damping,friction:e.friction,drag:e.drag,gravityY:-2,showParticles:!0,paused:!1},n=3,l=e.radius,B=l*2.02,I=new g(l*n*.9,l*n*.9,l*n*.9),C=D(1,I),m=[0,0,0,1];function z(t,f,a){const u=e.addBody(t,f,a,m[0],m[1],m[2],m[3],1,C.x,C.y,C.z);for(let d=0;d<n;d++)for(let c=0;c<n;c++)for(let r=0;r<n;r++)if(d===0||d===n-1||c===0||c===n-1||r===0||r===n-1){const h=(d-(n-1)*.5)*B,M=(c-(n-1)*.5)*B,G=(r-(n-1)*.5)*B;e.addParticle(u,h,M,G)}}for(let t=0;t<80;t++){const f=(Math.random()-.5)*6,a=1+t*.03,u=(Math.random()-.5)*6;z(f,a,u)}e.setSphereRadius(0,o.sphereRadius),e.setSpherePosition(0,0,1.2,0),e.step(e.fixedTimeStep||1/60);const s=new window.lil.GUI({title:"Sphere Interaction"});s.add(o,"sphereRadius",.2,3,.05).onChange(t=>e.setSphereRadius(0,t)),s.add(o,"stiffness",50,4e3,10).onChange(t=>e.stiffness=t),s.add(o,"damping",0,10,.05).onChange(t=>e.damping=t),s.add(o,"friction",0,3,.05).onChange(t=>e.friction=t),s.add(o,"drag",0,1,.02).onChange(t=>e.drag=t),s.add(o,"gravityY",-10,10,.1).onChange(t=>e.gravity=new g(0,t,0)),s.add(o,"showParticles"),s.add(o,"paused");let S=performance.now(),P=0,p=0;function b(){const t=performance.now(),f=(t-S)*.001;S=t,P++,p+=f,p>=1&&(E.textContent=Math.round(P/p).toString(),P=0,p=0);const a=t*.001,u=Math.sin(a*.6)*2.5,d=Math.cos(a*.45)*2.5,c=1.2+Math.sin(a*.9)*.8;e.setSpherePosition(0,u,c,d),o.paused||e.step(f);const r=v.getViewProj(i.width/i.height);y.updateBindGroup(e.getBodyPositionBuffer(),e.getBodyQuaternionBuffer()),x.updateBindGroup(e.getParticleWorldPositionBuffer()),x.updateViewProj(r,e.radius),y.render(e.bodyCount,{viewProj:r,drawExtras:h=>{R.update(r,{gridSize:.5,lineWidth:.04,height:0}),R.record(h),o.showParticles&&x.record(h,e.particleCount)}}),w.textContent=e.bodyCount.toString(),requestAnimationFrame(b)}b()}Y().catch(i=>{const w=document.getElementById("error");w.textContent=`Error: ${i.message||i}`,console.error(i)});
